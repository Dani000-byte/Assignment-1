•	LAG() - Month-over-month growth

-- Month-over-month sales growth percentage--
SELECT 
    month,
    monthly_sales,
    previous_month_sales,
    CASE 
        WHEN previous_month_sales IS NOT NULL THEN
            ROUND(((monthly_sales - previous_month_sales) / previous_month_sales) * 100, 2)
    END as growth_percentage
FROM (
    SELECT 
        TO_CHAR(sale_date, 'YYYY-MM') as month,
        SUM(amount) as monthly_sales,
        LAG(SUM(amount)) OVER (ORDER BY TO_CHAR(sale_date, 'YYYY-MM')) as previous_month_sales
    FROM transactions
    GROUP BY TO_CHAR(sale_date, 'YYYY-MM')
)
ORDER BY month;

•	LEAD() - Forward-looking analysis

-- Compare current month with next month --
SELECT 
    month,
    monthly_sales,
    LEAD(SUM(amount)) OVER (ORDER BY TO_CHAR(sale_date, 'YYYY-MM')) as next_month_sales
FROM transactions
GROUP BY TO_CHAR(sale_date, 'YYYY-MM')
ORDER BY month;
