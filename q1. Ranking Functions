â€¢	ROW_NUMBER() - Sequential ranking

-- Top customers by total revenue with sequential ranking--

  SELECT 
    c.region,
    QUARTER(t.transaction_date) AS sales_quarter,
    p.product_name,
    SUM(t.quantity_kg) AS total_sold,
    RANK() OVER (
        PARTITION BY c.region, QUARTER(t.transaction_date)
        ORDER BY SUM(t.quantity_kg) DESC
    ) AS product_rank
      FROM transactions t
     JOIN customers c ON t.customer_id = c.customer_id
    JOIN products p ON t.product_id = p.product_id
    GROUP BY c.region, sales_quarter, p.product_name
    ORDER BY c.region, sales_quarter, product_rank;
